diff --git a/gym_mod/gym_mod/envs/warhamEnv.py b/gym_mod/gym_mod/envs/warhamEnv.py
--- a/gym_mod/gym_mod/envs/warhamEnv.py
+++ b/gym_mod/gym_mod/envs/warhamEnv.py
@@
-        if sv is not None:
-            inv_txt = f"{inv}+" if inv is not None else "нет"
-            print(f"Save цели: {sv}+ (invul: {inv_txt})")
+        if sv is not None:
+            # В данных проекта часто invul=0 означает "нет инвула".
+            inv_txt = "нет"
+            if inv is not None:
+                try:
+                    inv_i = int(inv)
+                    if inv_i > 0:
+                        inv_txt = f"{inv_i}+"
+                except Exception:
+                    pass
+            print(f"Save цели: {sv}+ (invul: {inv_txt})")
@@
-            save_target = mod_sv
-            if inv is not None:
-                save_target = inv if save_target is None else min(save_target, inv)
+            save_target = mod_sv
+            # invul=0 в данных означает "нет инвула" — не должен улучшать сейв.
+            if inv is not None:
+                try:
+                    inv_i = int(inv)
+                except Exception:
+                    inv_i = None
+                if inv_i is not None and inv_i > 0:
+                    save_target = inv_i if save_target is None else min(save_target, inv_i)
@@
-        try:
-            total_damage = sum(dmg_list) if isinstance(dmg_list, (list, tuple)) else int(dmg_list)
-        except Exception:
-            total_damage = 0
+        try:
+            # dmg_list обычно numpy array; sum() работает, но isinstance не ловит ndarray.
+            if isinstance(dmg_list, (list, tuple, np.ndarray)):
+                total_damage = float(np.sum(dmg_list))
+            else:
+                total_damage = float(dmg_list)
+        except Exception:
+            total_damage = 0

diff --git a/gym_mod/gym_mod/engine/utils.py b/gym_mod/gym_mod/engine/utils.py
--- a/gym_mod/gym_mod/engine/utils.py
+++ b/gym_mod/gym_mod/engine/utils.py
@@
 def _weapon_has_lethal_hits(weapon) -> bool:
-    blob = _weapon_abilities_blob(weapon).lower()
-    # поддержим и формат [LETHAL HITS], и просто текст
-    return "lethal hits" in blob or "lethal_hit" in blob or "lethalhits" in blob
+    # 1) Нормальный формат данных: Abilities как dict
+    if isinstance(weapon, dict):
+        ab = weapon.get("Abilities")
+        if isinstance(ab, dict):
+            for k, v in ab.items():
+                key = str(k).lower().replace(" ", "")
+                if key == "lethalhits" and bool(v):
+                    return True
+
+    # 2) Фоллбек: строковые/списковые ключевые слова
+    blob = _weapon_abilities_blob(weapon).lower()
+    return "lethal hits" in blob or "lethal_hit" in blob or "lethalhits" in blob
@@
 def _weapon_rapid_fire_x(weapon) -> int:
-    """Возвращает X из [RAPID FIRE X] или 'Rapid Fire X'. Если нет — 0."""
-    blob = _weapon_abilities_blob(weapon).lower()
-
-    # [RAPID FIRE 1]
-    import re
-    m = re.search(r"rapid\s*fire\s*(\d+)", blob)
-    if not m:
-        # иногда пишут RAPIDFIRE 1
-        m = re.search(r"rapidfire\s*(\d+)", blob)
-    if not m:
-        return 0
-
-    try:
-        return int(m.group(1))
-    except Exception:
-        return 0
+    """Возвращает X из [RAPID FIRE X] / 'Rapid Fire X' или Abilities:{RapidFire:X}. Если нет — 0."""
+    # 1) Нормальный формат данных: Abilities как dict
+    if isinstance(weapon, dict):
+        ab = weapon.get("Abilities")
+        if isinstance(ab, dict):
+            for k, v in ab.items():
+                key = str(k).lower().replace(" ", "")
+                if key == "rapidfire":
+                    try:
+                        return int(v)
+                    except Exception:
+                        vv = _to_int(v, default=0)
+                        return int(vv or 0)
+
+    # 2) Фоллбек: строковые/списковые ключевые слова
+    blob = _weapon_abilities_blob(weapon).lower()
+
+    import re
+    m = re.search(r"rapid\s*fire[^0-9]*(\d+)", blob)
+    if not m:
+        # иногда пишут RAPIDFIRE 1 или это приходит как строка dict: "'RapidFire': 1"
+        m = re.search(r"rapidfire[^0-9]*(\d+)", blob)
+    if not m:
+        return 0
+
+    try:
+        return int(m.group(1))
+    except Exception:
+        return 0
