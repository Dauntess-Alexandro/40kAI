diff --git a/play.py b/play.py
index 681f0f4d3b5676d464f477dca1cd2d51e7305938..ceab92ac67b2f3fdc06907b562ba5ab047694fdd 100644
--- a/play.py
+++ b/play.py
@@ -116,52 +116,59 @@ env.attacker_side = attacker_side
 env.defender_side = defender_side
 
 state, info = env.reset(m=model, e=enemy)
 if verbose:
     squads_for_actions_count = len(model)
     _log(f"[action_space] squads_for_actions_count={squads_for_actions_count}")
     for idx, unit in enumerate(model):
         unit_data = unit.showUnitData()
         unit_name = unit_data.get("Name", "Unknown")
         _log(f"[action_space] squad[{idx}] name={unit_name}")
     total_models_count = 0
     for unit in model:
         unit_data = unit.showUnitData()
         total_models_count += int(unit_data.get("#OfModels", 1))
     _log(f"[action_space] total_models_count={total_models_count}")
     move_num_keys = [
         key for key in env.action_space.spaces.keys() if key.startswith("move_num_")
     ]
     _log(f"[action_space] move_num_keys_count={len(move_num_keys)}")
     _log(f"[action_space] move_num_keys={sorted(move_num_keys)}")
 n_actions = [5,2,len(info["player health"]), len(info["player health"]), 5, len(info["model health"])]
 for i in range(len(model)):
     n_actions.append(12)
 n_observations = len(state)
 
-policy_net = DQN(n_observations, n_actions).to(device)
-target_net = DQN(n_observations, n_actions).to(device)
+net_type = checkpoint.get("net_type") if isinstance(checkpoint, dict) else None
+dueling = net_type == "dueling"
+if not dueling and isinstance(checkpoint, dict):
+    policy_state = checkpoint.get("policy_net", {})
+    if any(key.startswith("value_heads.") for key in policy_state):
+        dueling = True
+
+policy_net = DQN(n_observations, n_actions, dueling=dueling).to(device)
+target_net = DQN(n_observations, n_actions, dueling=dueling).to(device)
 optimizer = torch.optim.Adam(policy_net.parameters())
 
 policy_net.load_state_dict(checkpoint['policy_net'])
 target_net.load_state_dict(checkpoint['target_net'])
 optimizer.load_state_dict(checkpoint['optimizer'])
 
 policy_net.eval()
 target_net.eval()
 
 isdone = False
 i = 0
 
 if playInGUI == True:
     env.reset(m=model, e=enemy, playType=playInGUI, Type="big", trunc=True)
 else:
     env.reset(m=model, e=enemy, playType=playInGUI, Type="big", trunc=False)
 
 env.io = io
 
 reward = 0
 io.log("\nИнструкции:\n")
 io.log("Игрок управляет юнитами, начинающимися с 1 (т.е. 11, 12 и т.д.)")
 io.log("Модель управляет юнитами, начинающимися с 2 (т.е. 21, 22 и т.д.)\n")
 
 while isdone == False:

