diff --git a/gym_mod/gym_mod/envs/warhamEnv.py b/gym_mod/gym_mod/envs/warhamEnv.py
index d3a07dcd4d13d7a2dc3f524d21b12bc9d4117f21..ec6ff7fd0e581cf355ac326cb1a3f26cd2d22c73 100644
--- a/gym_mod/gym_mod/envs/warhamEnv.py
+++ b/gym_mod/gym_mod/envs/warhamEnv.py
@@ -757,50 +757,68 @@ class Warhammer40kEnv(gym.Env):
         for i in range(len(model)):
             self.unit_weapon.append(model[i].showWeapon())
             self.unit_melee.append(model[i].showMelee())
             self.unit_data.append(model[i].showUnitData())
             self.unit_coords.append([model[i].showCoords()[0], model[i].showCoords()[1]])
             self.unit_health.append(model[i].showUnitData()["W"] * model[i].showUnitData()["#OfModels"])
             self.unitInAttack.append([0, 0])
             self.modelOC.append(model[i].showUnitData()["OC"])
 
         obsSpace = (len(model) * 3) + (len(enemy) * 3) + len(self.coordsOfOM * 2) + 2
         self.observation_space = spaces.Box(low=-np.inf, high=np.inf, shape=(obsSpace,), dtype=np.float32)
 
     def get_info(self):
         return {
             "model health": self.unit_health,
             "player health": self.enemy_health,
             "modelCP": self.modelCP,
             "playerCP": self.enemyCP,
             "in attack": self.unitInAttack,
             "model VP": self.modelVP,
             "player VP": self.enemyVP,
             "victory condition": self.vicCond,
             "turn": self.numTurns,
         }
 
+    def refresh_objective_control(self):
+        self.modelOnOM = np.array([-1] * len(self.coordsOfOM))
+        self.enemyOnOM = np.array([-1] * len(self.coordsOfOM))
+
+        for i in range(len(self.unit_health)):
+            if self.unit_health[i] <= 0:
+                continue
+            for j in range(len(self.coordsOfOM)):
+                if distance(self.coordsOfOM[j], self.unit_coords[i]) <= 5:
+                    self.modelOnOM[j] = i
+
+        for i in range(len(self.enemy_health)):
+            if self.enemy_health[i] <= 0:
+                continue
+            for j in range(len(self.coordsOfOM)):
+                if distance(self.coordsOfOM[j], self.enemy_coords[i]) <= 5:
+                    self.enemyOnOM[j] = i
+
     def reset(self, m, e, playType=False, Type="small", trunc=False):
         # keep original references too
         self.model = m
         self.enemy = e
 
         self.iter = 0
         self.trunc = trunc
         self.playType = playType
 
         if Type == "small":
             self.restarts += 1
         elif Type == "big":
             self.restarts = 0
             savePath = "display/"
             if os.path.isdir(savePath):
                 for fil in os.listdir(savePath):
                     try:
                         os.remove(os.path.join(savePath, fil))
                     except Exception:
                         pass
 
         self.board = np.zeros((self.b_len, self.b_hei))
         self.enemy_coords = []
         self.unit_coords = []
         self.enemy_health = []
@@ -1621,50 +1639,51 @@ class Warhammer40kEnv(gym.Env):
 
                         # Снимаем статусы боя
                         self.unitInAttack[i][0] = 0
                         self.unitInAttack[i][1] = 0
 
                         self.enemyInAttack[idOfE][0] = 0
                         self.enemyInAttack[idOfE][1] = 0
 
                     else:
                         # Остаёмся в бою — урон будет в Fight Phase (позже)
                         reward += 0.2
                         # (можно вообще без print, чтобы не засорять; оставляем тишину)
                         pass
 
 
             elif self.unit_health[i] == 0:
                 reward -= 1
                 if self.trunc is False:
                     print("Model unit", modelName, "is destroyed")
 
         # Fight Phase (10e simplified)
         self.resolve_fight_phase(active_side="model")
         self.enemyStrat["overwatch"] = -1
         self.enemyStrat["smokescreen"] = -1
 
+        self.refresh_objective_control()
         for i in range(len(self.modelOnOM)):
             if self.enemyOnOM[i] != -1 and self.modelOnOM[i] != -1:
                 if self.enemyOC[self.enemyOnOM[i]] < self.modelOC[self.modelOnOM[i]]:
                     self.modelVP += 1
             elif self.modelOnOM[i] != -1:
                 self.modelVP += 1
 
         for i in range(len(self.unit_health)):
             if self.unit_health[i] < 0:
                 self.unit_health[i] = 0
 
         for i in range(len(self.enemy_health)):
             if self.enemy_health[i] < 0:
                 self.enemy_health[i] = 0
 
         # Determine winning team
         if sum(self.unit_health) <= 0:
             self.game_over = True
             reward -= 2
             res = 4
         elif sum(self.enemy_health) <= 0:
             self.game_over = True
             reward += 2
             res = 4
 
@@ -2311,50 +2330,51 @@ class Warhammer40kEnv(gym.Env):
                         self.unitInAttack[idOfE][0] = 0
                         self.unitInAttack[idOfE][1] = 0
 
                     elif fallB.lower() == "quit":
                         self.game_over = True
                         info = self.get_info()
                         return self.game_over, info
                     else:
                         if self.playType is False:
                             fallB = input("It's a yes or no question dude: ")
                         else:
                             sendToGUI("It's a yes or no question dude: ")
                             fallB = recieveGUI()
 
             elif self.enemy_health[i] == 0:
                 if self.playType is False:
                     print("Unit", playerName, "is dead")
                 else:
                     sendToGUI("Unit {} is dead".format(playerName))
 
         if self.modelStrat["overwatch"] != -1:
             self.modelStrat["overwatch"] = -1
         if self.modelStrat["smokescreen"] != -1:
             self.modelStrat["smokescreen"] = -1
 
+        self.refresh_objective_control()
         for i in range(len(self.enemyOnOM)):
             if self.enemyOnOM[i] != -1 and self.modelOnOM[i] != -1:
                 if self.enemyOC[self.enemyOnOM[i]] > self.modelOC[self.modelOnOM[i]]:
                     self.enemyVP += 1
             elif self.enemyOnOM[i] != -1:
                 self.enemyVP += 1
 
         for k in range(len(self.enemy_health)):
             if self.enemy_health[k] < 0:
                 self.enemy_health[k] = 0
 
         self.iter += 1
         info = self.get_info()
         return self.game_over, info
 
     def updateBoard(self):
         self.render(mode="test")
         self.board = np.zeros((self.b_len, self.b_hei))
 
         for i in range(len(self.unit_health)):
             self.unit_coords[i] = bounds(self.unit_coords[i], self.b_len, self.b_hei)
             self.board[self.unit_coords[i][0]][self.unit_coords[i][1]] = 20 + i + 1
 
         for i in range(len(self.enemy_health)):
             self.enemy_coords[i] = bounds(self.enemy_coords[i], self.b_len, self.b_hei)

