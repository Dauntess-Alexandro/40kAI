diff --git a/gui/Application.cpp b/gui/Application.cpp
index 1df3da1c2be4216bbe317b583d480622f4bf82da..47cf9f025efbce1143a861a8fccfab7368812256 100644
--- a/gui/Application.cpp
+++ b/gui/Application.cpp
@@ -70,50 +70,51 @@ int findDefaultModelsCount(const std::string& faction, const std::string& name)
   }
   return 1;
 }
 }  // namespace
 
 std::string gifpth = "img/model_train.gif";
 std::string rewpth = "img/reward.png";
 std::string losspth = "img/loss.png";
 std::string eplenpth = "img/epLen.png";
 std::string winratepth = "img/winrate.png";
 std::string vpdiffpth = "img/vpdiff.png";
 std::string endreasonpth = "img/endreasons.png";
 std::string imgpth = "img/icon.png";
 
 Form :: Form() {
 
   modelClass = " Necrons";
   enemyClass = " Necrons";
   path = " ";
   open = false;
   x = 60;
   y = 40;
   training = false;
   playing = false;
   loadingRoster = false;
+  trainEnvPrefix = "";
 
   bar.set_show_close_button(true);
   bar.set_title("40kAI GUI");
   set_titlebar(bar);
 
   set_default_size(kDefaultWidth, kDefaultHeight);
   set_size_request(kMinimumWidth, kMinimumHeight);
 
   rootBox.set_orientation(Gtk::ORIENTATION_VERTICAL);
   topBarBox.set_orientation(Gtk::ORIENTATION_HORIZONTAL);
   topBarBox.set_spacing(8);
   leftBox.set_orientation(Gtk::ORIENTATION_VERTICAL);
   mainSplit.set_orientation(Gtk::ORIENTATION_HORIZONTAL);
   rightSplit.set_orientation(Gtk::ORIENTATION_VERTICAL);
 
   rootBox.set_hexpand(true);
   rootBox.set_vexpand(true);
   topBarBox.set_hexpand(true);
   leftBox.set_hexpand(true);
   leftBox.set_vexpand(true);
   mainSplit.set_hexpand(true);
   mainSplit.set_vexpand(true);
   rightSplit.set_hexpand(true);
   rightSplit.set_vexpand(true);
 
@@ -207,50 +208,51 @@ Form :: Form() {
   fixedTabPage1.move(radioBottom, 10, 130);
   radioBottom.set_label("Bottom");
   radioBottom.set_group(radioButtonGroup);
   radioBottom.signal_toggled().connect([this]() {
     tabControl1.set_tab_pos(PositionType::POS_BOTTOM);
   });
 
     // train tab
 
   savetoTxt(enemyUnits, modelUnits);
 
   labelPage2.set_label("Train");
   tabControl1.set_tab_label(tabPage2, labelPage2);
   tabPage2.add(fixedTabPage2);
 
   textbox1.set_text("Train Model:");
   setStatusMessage("Press the Train button to train a model");
     
   button1.set_label("Train");
   button1.signal_button_release_event().connect([&](GdkEventButton*) {
     saveLastRoster();
     syncEnemyUnitsFromRoster();
     updateInits(modelClass, enemyClass);
     if (exists_test("data.json") && training == false) {
       setStatusMessage("Training...");
+      trainEnvPrefix = "";
       startTrainInBackground();
     }
     return true;
   });
 
   numOfGames.set_text("# of Games in Training:");
   setIters.set_text("100");
 
   modelUnitLabel.set_text("Enter Model Units:");
   enemyUnitLabel.set_text("Enter Player Units:");
   openArmyPopup.set_label("Army Viewer");
   openArmyPopup.signal_button_release_event().connect([&](GdkEventButton*) {
     openArmyView();
     return true;
   });
 
   dimens.set_text("Dimensions of Board: ");
 
   dimX.set_text("X : ");
   enterDimensX.set_text(std::to_string(x));
   upX.set_label("+");
   upX.signal_button_release_event().connect([&](GdkEventButton*) {
     x+=10;
     enterDimensX.set_text(std::to_string(x));
     return true;
@@ -262,50 +264,63 @@ Form :: Form() {
     return true;
   });
 
   dimY.set_text("Y :");
   enterDimensY.set_text(std::to_string(y));
   upY.set_label("+");
   upY.signal_button_release_event().connect([&](GdkEventButton*) {
     y+=10;
     enterDimensY.set_text(std::to_string(y));
     return true;
   });
   downY.set_label("-");
   downY.signal_button_release_event().connect([&](GdkEventButton*) {
     y-=10;
     enterDimensY.set_text(std::to_string(y));
     return true;
   });
 
   button3.set_label("Clear Model Cache");
   button3.signal_button_release_event().connect([&](GdkEventButton*) {
     std::string mess = "Warning: You are about to delete all of the saved models";
     openWarnMenu(mess, 0);
     return true;
   });
 
+  buttonSelfPlay.set_label("Самообучение");
+  buttonSelfPlay.signal_button_release_event().connect([&](GdkEventButton*) {
+    saveLastRoster();
+    syncEnemyUnitsFromRoster();
+    updateInits(modelClass, enemyClass);
+    if (exists_test("data.json") && training == false) {
+      setStatusMessage("Самообучение: обучение...");
+      trainEnvPrefix = "SELF_PLAY_ENABLED=1 ";
+      startTrainInBackground();
+    }
+    return true;
+  });
+
   spmModel.set_label("Space Marine");
   spmModel.set_group(factionModel);
   spmModel.signal_toggled().connect([this]() {
     modelUnits.clear();
     modelClass = " Space_Marine";
   });
 
 
   orksModel.set_label("Orks");
   orksModel.set_group(factionModel);
   orksModel.signal_toggled().connect([this]() {
     modelUnits.clear();
     modelClass = " Orks";
   });
 
   sobModel.set_label("Sisters of Battle");
   sobModel.set_group(factionModel);
   sobModel.signal_toggled().connect([this]() {
     modelUnits.clear();
     modelClass = " Sisters_of_Battle";
   });
 
   adcModel.set_label("Adeptus Custodes");
   adcModel.set_group(factionModel);
   adcModel.signal_toggled().connect([this]() {
@@ -549,55 +564,57 @@ Form :: Form() {
   fixedTabPage2.add(necEnemy);
   fixedTabPage2.move(necEnemy, 270, 140);
   fixedTabPage2.add(modelUnitLabel);
   fixedTabPage2.move(modelUnitLabel, 10, 163);
   fixedTabPage2.add(enterModelUnit);
   fixedTabPage2.move(enterModelUnit, 130, 160);
   fixedTabPage2.add(modelEnter);
   fixedTabPage2.move(modelEnter, 300, 160);
   fixedTabPage2.add(enemyUnitLabel);
   fixedTabPage2.move(enemyUnitLabel, 10, 203);
   fixedTabPage2.add(enterEnemyUnit);
   fixedTabPage2.move(enterEnemyUnit, 130, 200);
   fixedTabPage2.add(enemyEnter);
   fixedTabPage2.move(enemyEnter, 300, 200);
   fixedTabPage2.add(clearAllModel);
   fixedTabPage2.move(clearAllModel, 340, 160);
   fixedTabPage2.add(clearAllEnemy);
   fixedTabPage2.move(clearAllEnemy, 340, 200);
   fixedTabPage2.add(mirrorRosterButton);
   fixedTabPage2.move(mirrorRosterButton, 400, 140);
   fixedTabPage2.add(openArmyPopup);
   fixedTabPage2.move(openArmyPopup, 400, (160+200)/2);
   fixedTabPage2.add(textbox1);
   fixedTabPage2.move(textbox1, 10, 10);
   fixedTabPage2.add(button1);
-  fixedTabPage2.move(button1, 150, 300);
+  fixedTabPage2.move(button1, 380, 300);
   fixedTabPage2.add(setIters);
   fixedTabPage2.move(setIters, 160, 40);
   fixedTabPage2.add(button3);
   fixedTabPage2.move(button3, 10, 300);
+  fixedTabPage2.add(buttonSelfPlay);
+  fixedTabPage2.move(buttonSelfPlay, 200, 300);
   fixedTabPage2.add(status);
   fixedTabPage2.move(status, 10, 350);
 
     // show trained model tab
 
   labelPage3.set_label("Show Trained Model");
   tabControl1.set_tab_label(tabPage3, labelPage3);
   tabPage3.add(fixedTabPage3);
 
   showModelHint.set_text("Preview shown in the right panel.");
   fixedTabPage3.add(showModelHint);
   fixedTabPage3.move(showModelHint, 10, 10);
   pictureBox1.set_size_request(280, 280);
   update_picture();
 
   // show metrics tab
   labelPage5.set_label("Model Metrics");
   tabControl1.set_tab_label(tabPage5, labelPage5);
   tabPage5.add(fixedTabPage5);
   
   chooseMetrics.set_label("Choose");
   chooseMetrics.signal_button_release_event().connect([&](GdkEventButton * event){
 	FileChooserDialog folderBrowserDialog("", FILE_CHOOSER_ACTION_OPEN);
     folderBrowserDialog.add_button("Cancel", RESPONSE_CANCEL);
     folderBrowserDialog.add_button("Open", RESPONSE_OK);
@@ -1053,50 +1070,51 @@ void Form :: update_metrics() {
   if (auto p = load_scaled(endreasonpth)) metricBox6.set(p);
 
 }
 
 void Form :: updateInits(std::string model, std::string enemy) {
   std::string command = "cd .. ; ./data.sh ";
   command.append(setIters.get_text().data());
   command.append(model);
   command.append(enemy);
   command.append(" ");
   command.append(enterDimensX.get_text().data());
   command.append(" ");
   command.append(enterDimensY.get_text().data());
   system(command.data());
 }
 
 void Form :: startTrainInBackground() {
   std::thread t(&Form::startTrain, this);
   t.detach();
 }
 
 void Form :: startTrain() {
   training = true;
   system("clear");
   std::string command = "cd .. ; ";
+  command.append(trainEnvPrefix);
   command.append("./train.sh");
   system(command.data());
   setStatusMessage("Completed!");
   training = false;
   update_picture();
   update_metrics();
 }
 
 void Form :: runPlayAgainstModelInBackground() {
   std::thread t(&Form::playAgainstModel, this);
   t.detach();
 }
   
 void Form :: playAgainstModel() {
   path = setModelFile.get_text();
 
   std::string envPrefix;
 
   std::string command;
 
   if (playInGUI == "True") {
     command = "cd .. ; " + envPrefix + "./play.sh ";
     if (strlen(path.data()) < 2) {
       command.append("None");
     } else {
diff --git a/gui/include/Application.h b/gui/include/Application.h
index 69adf90b87bda220a4ca8b16d16b015401e5f259..46a13d373383c61b6794474174350649300544d1 100644
--- a/gui/include/Application.h
+++ b/gui/include/Application.h
@@ -80,50 +80,51 @@ Image metricBox6;
   Label labelPage3;
   Label labelPage4;
   Label labelPage5;
   Label label1;
   Frame tabPage1;
   Frame tabPage2;
   Frame tabPage3;
   Frame tabPage4;
   Frame tabPage5;
   RadioButtonGroup radioButtonGroup;
   RadioButton radioTop;
   RadioButton radioLeft;
   RadioButton radioRight;
   RadioButton radioBottom;
   Fixed fixedTabPage1;
   Fixed fixedTabPage2;
   Fixed fixedTabPage3;
   Fixed fixedTabPage4;
   Fixed fixedTabPage5;
   Button button1;
   Button button2;
   Button button3;
   Button button4;
   Button button5;
   Button button6;
+  Button buttonSelfPlay;
   Button showBoard;
   Button showBoardImg;
   Button playGraphicsView;
   Label textbox;
   Label textbox2;
   Label textbox1;
   Label enemyFact;
   Label modelFact;
   Label status;
   Entry setIters;
   Entry setModelFile;
   RadioButtonGroup factionModel;
   RadioButton orksModel;
   RadioButton spmModel;
   RadioButton sobModel;
   RadioButton adcModel;
   RadioButton tyrModel;
   RadioButton milModel;
   RadioButton tauModel;
   RadioButton necModel;
   RadioButtonGroup factionEnemy;
   RadioButton orksEnemy;
   RadioButton spmEnemy;
   RadioButton sobEnemy;
   RadioButton adcEnemy;
@@ -149,28 +150,29 @@ Image metricBox6;
   Button enemyEnter;
   Button mirrorRosterButton;
   Button openArmyPopup;
   Entry enterModelUnit;
   Entry enterEnemyUnit;
   Button clearAllModel;
   Button clearAllEnemy;
   int x;
   int y;
   bool open;
   bool training;
   bool playing;
   bool loadingRoster;
   Label error;
   Label modelUnitLabel;
   Label enemyUnitLabel;
   std::vector<RosterEntry> modelUnits;
   std::vector<RosterEntry> enemyUnits;
   RosterModel rosterModel;
   HeaderBar bar;
   Button help;
   Button resetLayoutButton;
   Button chooseMetrics;
   Button playGUI;
   std::string playInGUI;
+  std::string trainEnvPrefix;
 };
 
 #endif

