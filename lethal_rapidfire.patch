--- a/gym_mod/gym_mod/engine/utils.py
+++ b/gym_mod/gym_mod/engine/utils.py
@@ -89,18 +89,105 @@
     return 5
 
 
-def attack(attackerHealth, attackerWeapon, attackerData, attackeeHealth, attackeeData,
-           rangeOfComb="Ranged", effects=None, roller=None):
+
+
+def _weapon_abilities_blob(weapon) -> str:
+    """Best-effort —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏/–∞–±–∏–ª–∫–∞–º–∏ –æ—Ä—É–∂–∏—è –≤ –æ–¥–∏–Ω blob."""
+    if not isinstance(weapon, dict):
+        return str(weapon)
+
+    parts = []
+    for k in (
+        "Abilities", "Ability", "Rules", "SpecialRules", "Special", "Keywords", "KeyWords", "Tags", "Type"
+    ):
+        v = weapon.get(k)
+        if v is None:
+            continue
+        if isinstance(v, (list, tuple)):
+            parts.extend([str(x) for x in v])
+        else:
+            parts.append(str(v))
+
+    return " ".join(parts)
+
+
+def _weapon_has_lethal_hits(weapon) -> bool:
+    blob = _weapon_abilities_blob(weapon).lower()
+    # –ø–æ–¥–¥–µ—Ä–∂–∏–º –∏ —Ñ–æ—Ä–º–∞—Ç [LETHAL HITS], –∏ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç
+    return "lethal hits" in blob or "lethal_hit" in blob or "lethalhits" in blob
+
+
+def _weapon_rapid_fire_x(weapon) -> int:
+    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç X –∏–∑ [RAPID FIRE X] –∏–ª–∏ 'Rapid Fire X'. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî 0."""
+    blob = _weapon_abilities_blob(weapon).lower()
+
+    # [RAPID FIRE 1]
+    import re
+    m = re.search(r"rapid\s*fire\s*(\d+)", blob)
+    if not m:
+        # –∏–Ω–æ–≥–¥–∞ –ø–∏—à—É—Ç RAPIDFIRE 1
+        m = re.search(r"rapidfire\s*(\d+)", blob)
+    if not m:
+        return 0
+
+    try:
+        return int(m.group(1))
+    except Exception:
+        return 0
+
+
+def _weapon_attacks_expr(weapon, default=1):
+    if not isinstance(weapon, dict):
+        return default
+    for k in ("Attacks", "A", "#Attacks", "Shots"):
+        if k in weapon:
+            v = weapon.get(k)
+            if v is not None:
+                return v
+    return default
+
+
+def _roll_attacks_expr(expr, _roll_fn):
+    """–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Attacks:
+      - int / numeric string
+      - "D3", "D6"
+
+    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç tuple: (value:int, rolled:bool)
     """
-    Attack resolution (–ø—Ä–∏–≤–µ–¥–µ–Ω–æ –∫ "10e-—Å—Ç–∏–ª—é" –±—Ä–æ—Å–∫–æ–≤):
-      - –ø–æ–ø–∞–¥–∞–Ω–∏–µ/—Ä–∞–Ω–µ–Ω–∏–µ/—Å–µ–π–≤: —É—Å–ø–µ—Ö –µ—Å–ª–∏ roll >= target (–Ω–∞–ø—Ä–∏–º–µ—Ä 4+)
-      - natural 1 –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–∞–ª
-      - —Å–µ–π–≤ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω, –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ > 6 (—Ç.–µ. 7+)
+    if isinstance(expr, (int, np.integer)):
+        return int(expr), False
+
+    if isinstance(expr, str):
+        e = expr.strip().upper()
+        if e == "D3":
+            return int(_roll_fn(min=1, max=3, num=1)), True
+        if e == "D6":
+            return int(_roll_fn(min=1, max=6, num=1)), True
+
+        # numeric-like string: "1", "2", "3+"...
+        v = _to_int(e, default=None)
+        if v is not None:
+            return int(v), False
+
+    # –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ —á—Ç–æ ‚Äî —Å—á–∏—Ç–∞–µ–º 1
+    return 1, False
+
+
+def attack(attackerHealth, attackerWeapon, attackerData, attackeeHealth, attackeeData,
+           rangeOfComb="Ranged", effects=None, roller=None, distance_to_target=None):
+    """Attack resolution (–ø—Ä–∏–≤–µ–¥–µ–Ω–æ –∫ "10e-—Å—Ç–∏–ª—é" –±—Ä–æ—Å–∫–æ–≤).
+
+    –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–æ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ):
+      - RAPID FIRE X: +X –∫ Attacks, –µ—Å–ª–∏ —Ü–µ–ª—å –≤ –ø–æ–ª–æ–≤–∏–Ω–µ –¥–∞–ª—å–Ω–æ—Å—Ç–∏
+      - LETHAL HITS: –∫—Ä–∏—Ç-—Ö–∏—Ç (–Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è 6) –∞–≤—Ç–æ-—Ä–∞–Ω–∏—Ç (–±–µ–∑ wound roll)
 
     roller:
       - None => –∏—Å–ø–æ–ª—å–∑—É–µ–º RNG dice()
       - –∏–Ω–∞—á–µ => —Ñ—É–Ω–∫—Ü–∏—è –±—Ä–æ—Å–∫–∞, —Å–∏–≥–Ω–∞—Ç—É—Ä–∞: roller(num=1, max=6) -> int –∏–ª–∏ list[int]
                  (min –≤ –ø—Ä–æ–µ–∫—Ç–µ –≤–µ–∑–¥–µ = 1)
+
+    distance_to_target:
+      - float/int (–¥—é–π–º—ã) ‚Äî –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –º–µ–∂–¥—É –∞—Ç–∞–∫—É—é—â–∏–º –∏ —Ü–µ–ª—å—é (–¥–ª—è Rapid Fire)
     """
 
     def _roll(min=1, max=6, num=1):
@@ -115,6 +202,7 @@
     # --- Targets / profile parsing ---
     sv_base = _to_int(attackeeData.get("Sv"), default=7)
     inv = _to_int(attackeeData.get("IVSave"), default=0)  # 0 = –Ω–µ—Ç –∏–Ω–≤—É–ª–∞
+
     bs = _to_int(attackerWeapon.get("BS") if rangeOfComb == "Ranged" else attackerWeapon.get("WS"), default=7)
 
     s = _to_int(attackerWeapon.get("S"), default=0)
@@ -138,8 +226,25 @@
         save_target = min(save_target, inv)
 
     # --- How many attacks? ---
-    # –í –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è "#OfModels" (–æ—á–µ–Ω—å –≥—Ä—É–±–æ), –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–∞–∫.
-    attacks = int(attackerData.get("#OfModels", 1))
+    n_models = int(attackerData.get("#OfModels", 1))
+    if n_models < 1:
+        n_models = 1
+
+    attacks_expr = _weapon_attacks_expr(attackerWeapon, default=1)
+    attacks_per_model, attacks_was_rolled = _roll_attacks_expr(attacks_expr, _roll)
+
+    # Rapid Fire X
+    if rangeOfComb == "Ranged":
+        rf = _weapon_rapid_fire_x(attackerWeapon)
+        if rf and distance_to_target is not None:
+            w_range = _to_int(attackerWeapon.get("Range"), default=None)
+            if w_range is not None and distance_to_target <= (w_range / 2):
+                attacks_per_model += int(rf)
+
+    if attacks_per_model < 1:
+        attacks_per_model = 1
+
+    attacks = int(n_models * attacks_per_model)
     if attacks < 1:
         attacks = 1
 
@@ -150,28 +255,48 @@
     else:
         rolls = np.array(list(rolls), dtype=int)
 
+    lethal = _weapon_has_lethal_hits(attackerWeapon)
+
     hits = 0
+    crit_hits = 0
     for r in rolls:
+        r = int(r)
         if r == 1:
             continue
+        if r == 6:
+            # –∫—Ä–∏—Ç-—Ö–∏—Ç (–∏ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–Ω–∏–µ)
+            hits += 1
+            crit_hits += 1
+            continue
         if r >= bs:
             hits += 1
 
     # --- WOUND ROLLS ---
     dmg_instances = []
-    if hits > 0:
-        wound_rolls = _roll(num=hits)
-        if isinstance(wound_rolls, int):
-            wound_rolls = np.array([wound_rolls], dtype=int)
-        else:
-            wound_rolls = np.array(list(wound_rolls), dtype=int)
 
+    if hits > 0:
         wt = _wound_target(s, t) if (s and t) else 7
-        for w in wound_rolls:
-            if w == 1:
-                continue
-            if w >= wt:
-                dmg_instances.append(_roll_damage_expr(attackerWeapon.get("Damage"), _roll))
+
+        auto_wounds = crit_hits if lethal else 0
+        # –∞–≤—Ç–æ-—Ä–∞–Ω—ã —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è–µ–º –∫–∞–∫ —É—Å–ø–µ—à–Ω—ã–µ —Ä–∞–Ω–µ–Ω–∏—è
+        for _ in range(auto_wounds):
+            dmg_instances.append(_roll_damage_expr(attackerWeapon.get("Damage"), _roll))
+
+        wound_roll_count = hits - crit_hits if lethal else hits
+
+        if wound_roll_count > 0:
+            wound_rolls = _roll(num=wound_roll_count)
+            if isinstance(wound_rolls, int):
+                wound_rolls = np.array([wound_rolls], dtype=int)
+            else:
+                wound_rolls = np.array(list(wound_rolls), dtype=int)
+
+            for w in wound_rolls:
+                w = int(w)
+                if w == 1:
+                    continue
+                if w >= wt:
+                    dmg_instances.append(_roll_damage_expr(attackerWeapon.get("Damage"), _roll))
 
     # --- SAVES ---
     if dmg_instances:
--- a/gym_mod/gym_mod/envs/warhamEnv.py
+++ b/gym_mod/gym_mod/envs/warhamEnv.py
@@ -271,7 +271,14 @@
     def print_shoot_report(self, weapon: dict, attacker_data: dict, defender_data: dict, dmg_list, effect=None):
         print("\nüìå --- –û–¢–ß–Å–¢ –ü–û –°–¢–†–ï–õ–¨–ë–ï ---")
 
-        bs = _get_int(attacker_data, ["BS", "Bs", "BallisticSkill", "BS+"], default=None)
+        # –í –¥–≤–∏–∂–∫–µ BS/WS –±–µ—Ä—ë–º –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –æ—Ä—É–∂–∏—è (–∫–∞–∫ –≤ 10e)
+        bs = _get_int(weapon, ["BS", "Bs", "BallisticSkill", "BS+"], default=None)
+        ws = _get_int(weapon, ["WS", "Ws", "WeaponSkill", "WS+"], default=None)
+
+        # –ï—Å–ª–∏ –ø–æ—á–µ–º—É-—Ç–æ BS/WS –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –æ—Ä—É–∂–∏–∏ ‚Äî –æ—Ç–∫–∞—Ç–∏–º—Å—è –∫ –¥–∞–Ω–Ω—ã–º —é–Ω–∏—Ç–∞ (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ)
+        if bs is None:
+            bs = _get_int(attacker_data, ["BS", "Bs", "BallisticSkill", "BS+"], default=None)
+
         s = _get_int(weapon, ["S", "Strength"], default=None)
 
         ap_val = 0
@@ -282,15 +289,24 @@
 
         t = _get_int(defender_data, ["T", "Toughness"], default=None)
         sv = _get_int(defender_data, ["Sv", "SV", "Save", "Sv+"], default=None)
-        inv = _get_int(defender_data, ["Invul", "Invulnerable", "Inv", "Invul+"], default=None)
+        inv = _get_int(defender_data, ["IVSave", "Invul", "Invulnerable", "Inv", "Invul+"], default=None)
 
         wname = weapon
         if isinstance(weapon, dict):
             wname = weapon.get("Name", weapon)
 
+        # –ê–±–∏–ª–∫–∏ –æ—Ä—É–∂–∏—è (–±–µ—Ä—ë–º –∏–∑ engine.utils, —Ç–∞–º –∂–µ, –≥–¥–µ —Ä–∞—Å—á—ë—Ç)
+        lethal = False
+        rf = 0
+        try:
+            lethal = bool(engine_utils._weapon_has_lethal_hits(weapon))
+            rf = int(engine_utils._weapon_rapid_fire_x(weapon) or 0)
+        except Exception:
+            pass
+
         print(f"–û—Ä—É–∂–∏–µ: {wname}")
         if bs is not None:
-            print(f"BS —Å—Ç—Ä–µ–ª–∫–∞: {bs}+")
+            print(f"BS –æ—Ä—É–∂–∏—è: {bs}+")
         if s is not None and t is not None:
             print(f"S vs T: {s} vs {t}  -> –±–∞–∑–æ–≤–æ —Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ {_wound_target(s, t)}+")
         if sv is not None:
@@ -298,6 +314,10 @@
             print(f"Save —Ü–µ–ª–∏: {sv}+ (invul: {inv_txt})")
         if ap_val != 0:
             print(f"AP: {ap_val}")
+        if rf:
+            print(f"–ü—Ä–∞–≤–∏–ª–æ: Rapid Fire {rf} (–≤ –ø–æ–ª–æ–≤–∏–Ω–µ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ +{rf} –∞—Ç–∞–∫)")
+        if lethal:
+            print("–ü—Ä–∞–≤–∏–ª–æ: Lethal Hits (–∫—Ä–∏—Ç-—Ö–∏—Ç—ã –∞–≤—Ç–æ-—Ä–∞–Ω—è—Ç)")
         if effect:
             print(f"–≠—Ñ—Ñ–µ–∫—Ç: {effect}")
 
@@ -308,16 +328,39 @@
         wound_rolls = self.calls[1 + off]["vals"] if len(self.calls) > (1 + off) else []
         save_rolls = self.calls[2 + off]["vals"] if len(self.calls) > (2 + off) else []
 
+        # --- hits ---
         hits = None
+        crit_hits = None
         if bs is not None and hit_rolls:
-            hits = sum(1 for r in hit_rolls if r >= bs)
+            crit_hits = sum(1 for r in hit_rolls if int(r) == 6)
+            hits = 0
+            for r in hit_rolls:
+                r = int(r)
+                if r == 1:
+                    continue
+                if r == 6:
+                    hits += 1
+                    continue
+                if r >= bs:
+                    hits += 1
 
+        # --- wounds ---
         wt = None
-        wounds = None
+        rolled_wounds = None
+        auto_wounds = 0
+        total_wounds = None
+
         if s is not None and t is not None and wound_rolls:
             wt = _wound_target(s, t)
-            wounds = sum(1 for r in wound_rolls if r >= wt)
+            rolled_wounds = sum(1 for r in wound_rolls if int(r) != 1 and int(r) >= wt)
 
+        if lethal and crit_hits is not None:
+            auto_wounds = int(crit_hits)
+
+        if rolled_wounds is not None:
+            total_wounds = rolled_wounds + (auto_wounds if lethal else 0)
+
+        # --- saves ---
         failed_saves = None
         save_target = None
         if (sv is not None or inv is not None) and save_rolls:
@@ -325,7 +368,6 @@
             if sv is not None:
                 base_sv = sv
                 if effect == "benefit of cover":
-                    # Benefit of Cover: +1 to saves => target improves by 1 (min 2+)
                     base_sv = max(2, sv - 1)
                 mod_sv = base_sv - ap_val
                 if mod_sv < 2:
@@ -337,9 +379,15 @@
             if inv is not None:
                 save_target = inv if save_target is None else min(save_target, inv)
 
-        if save_target is not None and wounds is not None:
-            saved = sum(1 for r in save_rolls if r >= save_target)
-            failed_saves = max(0, wounds - saved)
+        if save_target is not None and total_wounds is not None:
+            saved = 0
+            for r in save_rolls:
+                r = int(r)
+                if r == 1:
+                    continue
+                if save_target <= 6 and r >= save_target:
+                    saved += 1
+            failed_saves = max(0, total_wounds - saved)
 
         try:
             total_damage = sum(dmg_list) if isinstance(dmg_list, (list, tuple)) else int(dmg_list)
@@ -349,12 +397,22 @@
         if atk_rolls:
             print(f"\nAttacks roll: {atk_rolls}")
         if hit_rolls:
-            print(f"Hit rolls:    {hit_rolls}" + (f"  -> hits: {hits}" if hits is not None else ""))
+            extra = ""
+            if hits is not None:
+                extra = f"  -> hits: {hits}"
+                if crit_hits is not None and crit_hits > 0:
+                    extra += f" (crits: {crit_hits})"
+            print(f"Hit rolls:    {hit_rolls}{extra}")
+
         if wound_rolls:
-            if wt is not None:
-                print(f"Wound rolls:  {wound_rolls}  (—Ü–µ–ª—å {wt}+) -> wounds: {wounds}")
+            if wt is not None and rolled_wounds is not None:
+                if lethal and auto_wounds:
+                    print(f"Wound rolls:  {wound_rolls}  (—Ü–µ–ª—å {wt}+) -> rolled wounds: {rolled_wounds} + auto(w/LETHAL): {auto_wounds} = {total_wounds}")
+                else:
+                    print(f"Wound rolls:  {wound_rolls}  (—Ü–µ–ª—å {wt}+) -> wounds: {rolled_wounds}")
             else:
                 print(f"Wound rolls:  {wound_rolls}")
+
         if save_rolls:
             if save_target is not None:
                 fs = failed_saves if failed_saves is not None else "??"
@@ -363,7 +421,6 @@
                 print(f"Save rolls:   {save_rolls}")
 
         print(f"\n‚úÖ –ò—Ç–æ–≥ –ø–æ –¥–≤–∏–∂–∫—É: –ø—Ä–æ—à–ª–æ —É—Ä–æ–Ω–∞ = {total_damage}")
-        print("‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –æ—Ç—á—ë—Ç —Å—á–∏—Ç–∞–µ—Ç –±–∞–∑–æ–≤–æ (–±–µ–∑ –≤—Å–µ—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤/–∞–±–∏–ª–æ–∫). –ò—Ç–æ–≥–æ–≤—ã–π —É—Ä–æ–Ω ‚Äî –ø—Ä—è–º–æ –∏–∑ attack().")
         print("üìå -------------------------\n")
 
 class Warhammer40kEnv(gym.Env):
@@ -644,6 +701,7 @@
                                     self.unit_data[self.modelStrat["overwatch"]],
                                     self.enemy_health[i],
                                     self.enemy_data[i],
+                                    distance_to_target=distance(self.enemy_coords[i], self.unit_coords[self.modelStrat["overwatch"]]),
                                     roller=_logger.roll,
                                 )
                             else:
@@ -653,6 +711,7 @@
                                     self.unit_data[self.modelStrat["overwatch"]],
                                     self.enemy_health[i],
                                     self.enemy_data[i],
+                                    distance_to_target=distance(self.enemy_coords[i], self.unit_coords[self.modelStrat["overwatch"]]),
                                 )
                             self.enemy_health[i] = modHealth
                             if trunc is False and _logger is not None:
@@ -697,6 +756,7 @@
                                 self.unit_health[idOfM],
                                 self.unit_data[idOfM],
                                 effects=effect,
+                                distance_to_target=distance(self.enemy_coords[i], self.unit_coords[idOfM]),
                             )
                             self.unit_health[idOfM] = modHealth
                             if trunc is False:
@@ -912,6 +972,7 @@
                             self.enemy_data[self.enemyStrat["overwatch"]],
                             self.unit_health[i],
                             self.unit_data[i],
+                            distance_to_target=distance(self.unit_coords[i], self.enemy_coords[self.enemyStrat["overwatch"]]),
                         )
                         self.unit_health[i] = modHealth
                         if self.trunc is False:
@@ -964,6 +1025,7 @@
                                         self.enemy_health[idOfE],
                                         self.enemy_data[idOfE],
                                         effects=effect,
+                                        distance_to_target=distance(self.unit_coords[i], self.enemy_coords[idOfE]),
                                         roller=_logger.roll,
                                     )
                                 else:
@@ -974,6 +1036,7 @@
                                         self.enemy_health[idOfE],
                                         self.enemy_data[idOfE],
                                         effects=effect,
+                                        distance_to_target=distance(self.unit_coords[i], self.enemy_coords[idOfE]),
                                     )
                                 self.enemy_health[idOfE] = modHealth
                                 reward += 0.2
@@ -1583,6 +1646,7 @@
                                         self.unit_health[idOfE],
                                         self.unit_data[idOfE],
                                         effects=effect,
+                                        distance_to_target=distance(self.enemy_coords[i], self.unit_coords[idOfE]),
                                         roller=logger.roll,
                                     )
 
